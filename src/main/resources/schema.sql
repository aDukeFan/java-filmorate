
DROP TABLE IF EXISTS users, follows, ratings, genres, films, likes, genres_films, reviews, reviews_likes CASCADE;

create table if not exists users (
id integer generated by default as identity not null primary key,
name varchar(255),
email varchar(255) not null,
login varchar(255) not null,
birthday date
);

create table if not exists follows (
following_id integer not null references users(id),
followed_id integer not null references users(id)
);

create table if not exists ratings (
id integer generated by default as identity not null primary key,
name varchar(200) not null unique
);

create table if not exists genres (
id integer generated by default as identity not null primary key,
name varchar (200) not null unique
);

create table if not exists films (
id integer generated by default as identity not null primary key,
name varchar(200),
description varchar(200),
release date,
duration integer not null,
rating_id integer, foreign key (rating_id) references ratings(id)
);

create table if not exists likes (
film_id integer not null references films(id),
user_id integer not null references users(id)
);

create table if not exists genres_films (
genre_id integer not null references genres(id),
film_id integer not null references films(id)
);

create table if not exists reviews (
id int generated by default as identity not null primary key,
content varchar(500) not null,
is_positive boolean,
user_id int not null,
film_id int not null,
useful int default 0
);

create table if not exists reviews_likes (
review_id integer not null,
user_id integer not null,
review_like integer
);
